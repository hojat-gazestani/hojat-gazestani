(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{6562:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>d});var t=r(7876),i=r(7328),l=r.n(i),c=r(8230),n=r.n(c),a=r(4587),o=r.n(a);function d(){return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,t.jsxs)(l(),{children:[(0,t.jsx)("title",{children:"Ceph CSI Setup Guide | Your Name"}),(0,t.jsx)("meta",{name:"description",content:"Step-by-step guide to setting up Ceph CSI in Kubernetes"})]}),(0,t.jsxs)("article",{className:"prose prose-lg dark:prose-invert",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Ceph CSI Setup in Kubernetes"}),(0,t.jsxs)("div",{className:"flex items-center mb-8",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Published: July 28, 2023"}),(0,t.jsx)("span",{className:"mx-2",children:"•"}),(0,t.jsx)("span",{className:"text-gray-500",children:"5 min read"})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)(o(),{src:"/images/ceph-csi-diagram.png",alt:"Ceph CSI Architecture Diagram",className:"rounded-lg shadow-md"})}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mt-8 mb-4",children:"Introduction"}),(0,t.jsx)("p",{children:"Ceph CSI (Container Storage Interface) allows Kubernetes to use Ceph RBD and CephFS volumes as persistent storage for containerized applications. In this guide, I will walk through the setup process I used in my production environment."})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mt-8 mb-4",children:"Prerequisites"}),(0,t.jsxs)("ul",{className:"list-disc pl-6 space-y-2",children:[(0,t.jsx)("li",{children:"Kubernetes cluster (v1.17+)"}),(0,t.jsx)("li",{children:"Ceph cluster (Nautilus or newer)"}),(0,t.jsx)("li",{children:"kubectl configured with cluster access"}),(0,t.jsx)("li",{children:"Helm (for simplified deployment)"})]})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mt-8 mb-4",children:"Installation Steps"}),(0,t.jsx)("h3",{className:"text-xl font-medium mt-6 mb-3",children:"1. Create Ceph User"}),(0,t.jsx)("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-x-auto",children:(0,t.jsx)("code",{children:"ceph auth get-or-create client.kubernetes   mon 'allow r'   osd 'allow rwx pool=kube'   mgr 'allow r'"})}),(0,t.jsx)("h3",{className:"text-xl font-medium mt-6 mb-3",children:"2. Deploy Ceph CSI via Helm"}),(0,t.jsx)("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-x-auto",children:(0,t.jsx)("code",{children:"helm repo add ceph-csi https://ceph.github.io/csi-charts\nhelm install ceph-csi-rbd ceph-csi/ceph-csi-rbd --namespace ceph-csi --create-namespace"})}),(0,t.jsx)("h3",{className:"text-xl font-medium mt-6 mb-3",children:"3. Create StorageClass"}),(0,t.jsx)("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-x-auto",children:(0,t.jsx)("code",{children:"apiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: ceph-rbd\nprovisioner: rbd.csi.ceph.com\nparameters:\n  clusterID: <ceph-cluster-id>\n  pool: kube\n  imageFeatures: layering\n  csi.storage.k8s.io/provisioner-secret-name: ceph-csi-secret\n  csi.storage.k8s.io/node-stage-secret-name: ceph-csi-secret"})})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mt-8 mb-4",children:"Troubleshooting"}),(0,t.jsx)("p",{children:"Common issues I encountered:"}),(0,t.jsxs)("ul",{className:"list-disc pl-6 space-y-2",children:[(0,t.jsx)("li",{children:"Permission errors - double check your Ceph user capabilities"}),(0,t.jsx)("li",{children:"CSI pods in CrashLoopBackoff - verify your clusterID and monitor addresses"}),(0,t.jsx)("li",{children:"Mount timeouts - check network connectivity between nodes and Ceph cluster"})]})]}),(0,t.jsx)("div",{className:"mt-12 pt-6 border-t border-gray-200 dark:border-gray-700",children:(0,t.jsx)(n(),{href:"/blog",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"← Back to Blog"})})]})]})}},7360:(e,s,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/ceph-csi-setup",function(){return r(6562)}])}},e=>{e.O(0,[587,695,636,593,792],()=>e(e.s=7360)),_N_E=e.O()}]);